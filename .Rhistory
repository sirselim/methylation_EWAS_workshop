load('data/Ilmn450K_anno.RDS')
meth.anno <- readRDS('data/Ilmn450K_anno.RDS')
head(meth.anno)
load('data/blood_buccal.RData')
c(rep(0, 5), rep(1, 5))
require(minfi)
GSE40279 <- annotation[grep('GSE40279', annotation$GSE),]
GSE40279.betas <- getbeta(samples=GSE40279$Id, probes=meth.anno$IlmnID, marmalaiddir='/publicdata/marmalaid/')
buccal <- annotation[grep('Buccal', annotation$TISSUE),]
GSE40279
colnames(betas)
y <- c(rep(0, 5), rep(1, 5))
y <- as.factor(y)
levels(y) <- c('Blood', 'Buccal')
tissues <- c(rep(0, 5), rep(1, 5))
tissues <- as.factor(tissues)
levels(tissues) <- c('Blood', 'Buccal')
tissues
names(tissues)
names(tissues) <- samples
names(tissues) <- Samples
tissues
densityPlot(betas, sampGroups = tissues)
require(marmalaid)
GSE40279 <- annotation[grep('GSE40279', annotation$GSE),]
GSE40279.betas <- getbeta(samples=GSE40279$Id, probes=meth.anno$IlmnID, marmalaiddir='/publicdata/marmalaid/')
GSE40279.betas <- getbeta(samples=GSE40279$Id, probes=meth.anno$IlmnID)
d <- t(betas)
rownames(d) <- samples
samples
rownames(d) <- tissues
d <- dist(d, method = "minkowski", p = 2)
hc <- hclust(d)
plot(hc, main="Cluster on all probes", labels = pd$Sample_Name)
plot(hc, main="Cluster on all probes", labels = tissues)
?dmpFinder
results <- dmpFinder(betas, pheno = tissues, type = "categorical", qCutoff = 1)
head(results)
plotCpg(betas, cpg = "cg05350268", pheno = tissues, type = "categorical", measure = "beta")
plotCpg(betas, cpg = "cg05350268", pheno = tissues, type = "categorical", measure = "beta",
ylab = "methylation (beta)", xlab = 'tissue')
plotCpg(betas, cpg = "cg05350268", pheno = tissues, type = "categorical", measure = "beta",
ylab = "methylation (beta)", col = c('red', 'blue'))
?plotCpg
betas[[cg05350268]]
betas[cg05350268,]
betas['cg05350268',]
boxplot(betas['cg05350268',] ~ tissues)
boxplot(betas['cg05350268',] ~ tissues, col = c('darkred', 'cadetblue'))
head(results)
boxplot(betas['cg19653345',] ~ tissues, col = c('darkred', 'cadetblue'))
boxplot(betas['cg03467405',] ~ tissues, col = c('darkred', 'cadetblue'))
boxplot(betas['cg07046426',] ~ tissues, col = c('darkred', 'cadetblue'))
tissue.sites <- rownames(results)[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'))
}
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = i)
}
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg)
}
getwd()
pdf('figures/blood_v_buccal_topsites_plot.pdf')
tissue.sites <- rownames(results)[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg)
}
dev.off()
pdf('figures/blood_v_buccal_topsites_plot.pdf', paper = 'a4')
tissue.sites <- rownames(results)[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg)
}
dev.off()
pdf('figures/blood_v_buccal_topsites_plot.pdf', paper = 'a4r')
tissue.sites <- rownames(results)[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg)
}
dev.off()
pdf('figures/blood_v_buccal_topsites_plot.pdf', width = 7, height = 10)
tissue.sites <- rownames(results)[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg)
}
dev.off()
pdf('figures/blood_v_buccal_topsites_plot.pdf', width = 7, height = 10)
tissue.sites <- rownames(results)[c(1:12)]
par(mfrow = c(4,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg)
}
dev.off()
head(results)
table(results$qval < 0.05)
table(results$qval < 0.005)
table(results$qval < 0.0005)
table(results$qval < 0.00005)
top.results <- results[results$qval < 0.00005,]
tail(top.results)
head(top.results)
top.results <- results[results$qval <= 0.00005,]
top.results <- na.omit(top.results)
tail(top.results)
plotCpg(betas, cpg = "cg20432671", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
top.results <- results[results$qval <= 0.05,]
top.results <- na.omit(top.results)
tail(top.results)
plotCpg(betas, cpg = "cg07049424", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
top.results <- results[results$qval <= 0.005,]
top.results <- na.omit(top.results)
tail(top.results)
plotCpg(betas, cpg = "cg14730445", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
top.results <- results[results$qval <= 0.0005,]
top.results <- na.omit(top.results)
tail(top.results)
plotCpg(betas, cpg = "cg03720950", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
0.05/450000
top.results <- results[results$pval <= (0.05/450000),]
tail(top.results)
top.results <- na.omit(top.results)
tail(top.results)
plotCpg(betas, cpg = "cg00932510", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
top.results <- results[results$qval <= 0.0005,]
top.results <- na.omit(top.results)
top.results <- results[results$qval <= 0.00005,]
top.results <- na.omit(top.results)
top.results <- results[results$qval <= 0.00005,]
top.results <- na.omit(top.results)
tail(top.results)
plotCpg(betas, cpg = "cg20432671", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
tail(results)
results <- na.omit(results)
head(results)
tail(results)
table(results$qval < 0.00005)
top.results <- results[results$qval <= 0.00005,]
tail(top.results)
tail(results)
plotCpg(betas, cpg = "cg00241218", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
top.results <- results[results$pval <= (0.05/450000),]
table(results$pval <= (0.05/450000))
top.results <- results[results$qval <= 0.00005,]
tail(top.results)
table(results$qval < 0.00005)
plotCpg(betas, cpg = "cg05350268", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
plotCpg(betas, cpg = "cg00241218", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
head(results)
tail(results)
plotCpg(betas, cpg = "cg07309136", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
plotCpg(betas, cpg = "cg05350268", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
plotCpg(betas, cpg = "cg07309136", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)")
boxplot(betas['cg05350268',] ~ tissues, col = c('darkred', 'cadetblue'))
boxplot(betas['cg19653345',] ~ tissues, col = c('darkred', 'cadetblue'))
boxplot(betas['cg03467405',] ~ tissues, col = c('darkred', 'cadetblue'))
boxplot(betas['cg07046426',] ~ tissues, col = c('darkred', 'cadetblue'))
boxplot(betas['cg05350268',] ~ tissues, col = c('darkred', 'cadetblue'), ylim = c(0,1))
plotCpg(betas, cpg = "cg05350268", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)", ylim = c(0,1))
plotCpg(betas, cpg = "cg07309136", pheno = tissues, type = "categorical", measure = "beta", ylab = "methylation (beta)", ylim = c(0,1))
boxplot(betas['cg05350268',] ~ tissues, col = c('darkred', 'cadetblue'), ylim = c(0,1))
boxplot(betas['cg19653345',] ~ tissues, col = c('darkred', 'cadetblue'), ylim = c(0,1))
boxplot(betas['cg03467405',] ~ tissues, col = c('darkred', 'cadetblue'), ylim = c(0,1))
boxplot(betas['cg07046426',] ~ tissues, col = c('darkred', 'cadetblue'), ylim = c(0,1))
# loop through a few sites
tissue.sites <- rownames(results)[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg, ylim = c(0,1))
}
tissue.sites <- rownames(tail(results, n = 12))[c(1:9)]
par(mfrow = c(3,3))
for (cpg in tissue.sites) {
boxplot(betas[cpg,] ~ tissues, col = c('darkred', 'cadetblue'), ylab = "methylation (beta)", xlab = "tissue", main = cpg, ylim = c(0,1))
}
sig.betas <- betas[rownames(betas) %in% rownames(top.results),]
d <- t(sig.betas)
rownames(d) <- tissues
d <- dist(d, method = "minkowski", p = 2)
hc <- hclust(d)
plot(hc, main="Cluster on selected top tissue discrimination CpG sites", labels = tissues)
d <- t(sig.betas)
rownames(d) <- tissues
d <- dist(d, method = "minkowski", p = 2)
hc <- hclust(d)
plot(hc, main="Cluster on selected top tissue discrimination CpG sites", labels = tissues)
head(GSE48472)
head(GSE40279)
head(samples)
samples
?hc
head(annotation)
head(meth.anno)
meth.anno <- readRDS('data/Ilmn450K_anno.RDS')
head(meth.anno)
anno.sub <- meth.anno[meth.anno$IlmnID %in% rownames(top.results),]
table(anno.sub$CHR)
table(anno.sub$UCSC_RefGene_Name) #
unique(anno.sub$UCSC_RefGene_Name) #
unique(unlist(strsplit(anno.sub$UCSC_RefGene_Name, split = ';'))) #
length(unique(unlist(strsplit(anno.sub$UCSC_RefGene_Name, split = ';')))) #
genes <- length(unique(unlist(strsplit(anno.sub$UCSC_RefGene_Name, split = ';'))))
write.table(genes, 'EWAS_blood_buccal_genelist.txt', row.names = F, col.names = F)
genes <- unique(unlist(strsplit(anno.sub$UCSC_RefGene_Name, split = ';')))
write.table(genes, 'EWAS_blood_buccal_genelist.txt', row.names = F, col.names = F)
write.table(genes, 'EWAS_blood_buccal_genelist.txt', row.names = F, col.names = F, quote = F)
